#!/bin/bash
#
# Create user in SQL-Ledger
#
# Created by Karoly Molnar <kmolnar@cirruscomputing.com>
#
# Copyright (c) 1996-2011 Free Open Source Solutions Inc.
# All Rights Reserved
#
# Free Open Source Solutions Inc. owns and reserves all rights, title,
# and interest in and to this software in both machine and human
# readable forms.
#
# Customers say that they don't want all emplyees to have access to the accounts.
# RWL Feb 2013
exit 0

# Parameters set at deploy time
DB_PASSWORD_SQL_LEDGER="[-DB_PASSWORD_SQL_LEDGER-]"
SQL_LEDGER_PASSWORD_ADMIN="[-SQL_LEDGER_PASSWORD_ADMIN-]"
COMPANY_NAME="[-ORG_FULL_NAME-]"
LDAP_PASSWORD_LIBNSS="[-LDAP_PASSWORD_LIBNSS-]"

# Variables
BIN_FOLDER=${0%/*}
AWK_FOLDER=$BIN_FOLDER/awk
DOMAIN=$(hostname -d)
LDAP_BASE=$(awk '$1 ~ "^BASE" {print $2}' /etc/ldap/ldap.conf 2>>/dev/null)
COOKIE=$(mktemp)

# Parameters given at runtime
USERNAME="$1"
USER_PASSWORD="$2"

# Read full name from LDAP
USER_FULL_NAME=$(ldapsearch -x -w "$LDAP_PASSWORD_LIBNSS" -D cn=libnss,ou=applications,ou=system,$LDAP_BASE uid=$USERNAME cn | grep cn: | sed 's/^cn: \(.*\)$/\1/')

# Determine email address
ALTERNATE_MAIL=$(ldapsearch -x -w "$LDAP_PASSWORD_LIBNSS" -D cn=libnss,ou=applications,ou=system,$LDAP_BASE uid=$USERNAME eseriMailAlternateAddress | grep eseriMailAlternateAddress: | sed 's/^eseriMailAlternateAddress: \(.*\)$/\1/')
if [ ${#ALTERNATE_MAIL} -gt 3 ] ; then
        EMAIL_ADDRESS=$ALTERNATE_MAIL
else
        EMAIL_ADDRESS="$USERNAME@$DOMAIN"
fi

# URL Encode variables
USER_FULL_NAME_ENCODED=$(echo "$USER_FULL_NAME" | awk -f $AWK_FOLDER/urlencode.awk)
USER_EMAIL_ENCODED=$(echo "$EMAIL_ADDRESS" | awk -f $AWK_FOLDER/urlencode.awk)
COMPANY_NAME_ENCODED=$(echo "$COMPANY_NAME" | awk -f $AWK_FOLDER/urlencode.awk)

# Encrypt default password
SQL_LEDGER_PASSWORD_ADMIN_ENCRYPTED=$(perl -e "print crypt '${SQL_LEDGER_PASSWORD_ADMIN}', 'ro';")

# Read actual encrypted password
SQL_LEDGER_PASSWORD_ADMIN_ACTUAL=$(awk -f $AWK_FOLDER/sql-ledger-members-read-password.awk -v PASSWORD="test" /var/lib/sql-ledger/users/members | awk 'BEGIN{FS="="} /password/ {print $2}')

# Set the SQL-Ledger root password to default if it is set to something else
if [ "$SQL_LEDGER_PASSWORD_ADMIN_ENCRYPTED" != "$SQL_LEDGER_PASSWORD_ADMIN_ACTUAL" ]; then
	awk -f $AWK_FOLDER/sql-ledger-members-set-password.awk -v PASSWORD="$SQL_LEDGER_PASSWORD_ADMIN_ENCRYPTED" /var/lib/sql-ledger/users/members >/var/lib/sql-ledger/users/members.tmp
	chown www-data:www-data /var/lib/sql-ledger/users/members.tmp
	mv /var/lib/sql-ledger/users/members.tmp /var/lib/sql-ledger/users/members
fi

function CURL {
	if [ ! -e $COOKIE ]; then
		curl -c $COOKIE -d "$1" http://sql-ledger.$DOMAIN/admin.pl
	else
		curl -b $COOKIE -c $COOKIE -d "$1" http://sql-ledger.$DOMAIN/admin.pl
	fi
}

# Login
CURL "password=${SQL_LEDGER_PASSWORD_ADMIN}&action=Login&action=login&path=bin%2Fmozilla"

# Create user
CURL "path=bin%2Fmozilla&action=Add+User"

if [ $(grep '^\[.*\]$' /var/lib/sql-ledger/users/members |wc -l) -gt 1 ]; then
	# Regular user
	CURL "login=${USERNAME}&new_password=${USER_PASSWORD}&old_password=&name=${USER_FULL_NAME_ENCODED}&email=${USER_EMAIL_ENCODED}&signature=&tel=&fax=&company=${COMPANY_NAME_ENCODED}&dateformat=mm-dd-yy&numberformat=1%2C000.00&vclimit=1000&menuwidth=155&countrycode=&newtimeout=10800&userstylesheet=sql-ledger.css&printer=&usetemplates=default&newtemplates=&mastertemplates=Default&templates=&dbdriver=Pg&Pg_dbhost=pgsql.${DOMAIN}&Pg_dbname=sql-ledger&Pg_dbport=5432&Pg_dbuser=sql-ledger&Pg_dbpasswd=${DB_PASSWORD_SQL_LEDGER}&old_dbpasswd=&role=user&AR--Add%2520Transaction=1&AR--Sales%2520Invoice=1&AR--Credit%2520Note=1&AR--Credit%2520Invoice=1&AR--Reports=1&AR--Reports--Transactions=1&AR--Reports--Outstanding=1&AR--Reports--AR%2520Aging=1&AR--Reports--Reminder=1&AR--Reports--Tax%2520collected=1&AR--Reports--Non-taxable=1&POS--Sale=1&POS--Open=1&POS--Receipts=1&Customers--Add%2520Customer=1&Customers--Reports=1&Customers--Reports--Search=1&Customers--Reports--History=1&AP--Add%2520Transaction=1&AP--Vendor%2520Invoice=1&AP--Debit%2520Note=1&AP--Debit%2520Invoice=1&AP--Reports=1&AP--Reports--Transactions=1&AP--Reports--Outstanding=1&AP--Reports--AP%2520Aging=1&AP--Reports--Tax%2520paid=1&AP--Reports--Non-taxable=1&Vendors--Add%2520Vendor=1&Vendors--Reports=1&Vendors--Reports--Search=1&Vendors--Reports--History=1&Cash--Receipt=1&Cash--Receipts=1&Cash--Payment=1&Cash--Payments=1&Cash--FX%2520Adjustment=1&Cash--Reconciliation=1&Cash--Reports=1&Cash--Reports--Receipts=1&Cash--Reports--Payments=1&Cash--Reports--Reconciliation=1&Vouchers--Payable=1&Vouchers--Payment=1&Vouchers--Payments=1&Vouchers--Payment%2520Reversal=1&Vouchers--General%2520Ledger=1&Vouchers--Reports=1&Vouchers--Reports--All%2520Batches=1&Vouchers--Reports--Payable=1&Vouchers--Reports--Payment=1&Vouchers--Reports--Payment%2520Reversal=1&Vouchers--Reports--General%2520Ledger=1&HR--Employees=1&HR--Employees--Add%2520Employee=1&HR--Employees--Reports=1&Order%2520Entry--Sales%2520Order=1&Order%2520Entry--Purchase%2520Order=1&Order%2520Entry--Reports=1&Order%2520Entry--Reports--Sales%2520Orders=1&Order%2520Entry--Reports--Requirements=1&Order%2520Entry--Reports--Purchase%2520Orders=1&Order%2520Entry--Generate=1&Order%2520Entry--Generate--Purchase%2520Orders=1&Order%2520Entry--Consolidate=1&Order%2520Entry--Consolidate--Sales%2520Orders=1&Order%2520Entry--Consolidate--Purchase%2520Orders=1&Shipping--Ship=1&Shipping--Receive=1&Quotations--Quotation=1&Quotations--RFQ=1&Quotations--Reports=1&Quotations--Reports--Quotations=1&Quotations--Reports--RFQs=1&General%2520Ledger--Add%2520Transaction=1&General%2520Ledger--Reports=1&Goods%2520%2526%2520Services--Add%2520Part=1&Goods%2520%2526%2520Services--Add%2520Service=1&Goods%2520%2526%2520Services--Add%2520Assembly=1&Goods%2520%2526%2520Services--Add%2520Labor%252fOverhead=1&Goods%2520%2526%2520Services--Add%2520Group=1&Goods%2520%2526%2520Services--Add%2520Pricegroup=1&Goods%2520%2526%2520Services--Stock%2520Assembly=1&Goods%2520%2526%2520Services--Changeup=1&Goods%2520%2526%2520Services--Changeup--Assembly=1&Goods%2520%2526%2520Services--Changeup--Part=1&Goods%2520%2526%2520Services--Changeup--Service=1&Goods%2520%2526%2520Services--Changeup--Labor%252fOverhead=1&Goods%2520%2526%2520Services--Reports=1&Goods%2520%2526%2520Services--Reports--All%2520Items=1&Goods%2520%2526%2520Services--Reports--Parts=1&Goods%2520%2526%2520Services--Reports--Requirements=1&Goods%2520%2526%2520Services--Reports--Services=1&Goods%2520%2526%2520Services--Reports--Labor%252fOverhead=1&Goods%2520%2526%2520Services--Reports--Groups=1&Goods%2520%2526%2520Services--Reports--Pricegroups=1&Goods%2520%2526%2520Services--Reports--Assemblies=1&Goods%2520%2526%2520Services--Reports--Components=1&Goods%2520%2526%2520Services--Translations=1&Goods%2520%2526%2520Services--Translations--Description=1&Goods%2520%2526%2520Services--Translations--Groups=1&Projects--Add%2520Project=1&Projects--Add%2520Time%2520Card=1&Projects--Reports=1&Projects--Reports--List%2520Projects=1&Projects--Reports--Transactions=1&Projects--Reports--Time%2520Cards=1&Projects--Generate=1&Projects--Generate--Sales%2520Orders=1&Projects--Translations=1&Projects--Translations--Description=1&Reports--Chart%2520of%2520Accounts=1&Reports--Trial%2520Balance=1&Reports--Income%2520Statement=1&Reports--Balance%2520Sheet=1&Batch--Print=1&Batch--Print--Sales%2520Invoices=1&Batch--Print--Remittance%2520Vouchers=1&Batch--Print--Sales%2520Orders=1&Batch--Print--Work%2520Orders=1&Batch--Print--Quotations=1&Batch--Print--Packing%2520Lists=1&Batch--Print--Pick%2520Lists=1&Batch--Print--Vendor%2520Invoices=1&Batch--Print--Purchase%2520Orders=1&Batch--Print--Bin%2520Lists=1&Batch--Print--RFQs=1&Batch--Print--Time%2520Cards=1&Batch--Email=1&Batch--Email--Sales%2520Invoices=1&Batch--Email--Remittance%2520Vouchers=1&Batch--Email--Sales%2520Orders=1&Batch--Email--Work%2520Orders=1&Batch--Email--Quotations=1&Batch--Email--Packing%2520Lists=1&Batch--Email--Pick%2520Lists=1&Batch--Email--Vendor%2520Invoices=1&Batch--Email--Purchase%2520Orders=1&Batch--Email--Bin%2520Lists=1&Batch--Email--RFQs=1&Batch--Queue=1&Batch--Queue--Sales%2520Invoices=1&Batch--Queue--Remittance%2520Vouchers=1&Batch--Queue--Sales%2520Orders=1&Batch--Queue--Work%2520Orders=1&Batch--Queue--Quotations=1&Batch--Queue--Packing%2520Lists=1&Batch--Queue--Pick%2520Lists=1&Batch--Queue--Vendor%2520Invoices=1&Batch--Queue--Purchase%2520Orders=1&Batch--Queue--Bin%2520Lists=1&Batch--Queue--RFQs=1&Batch--Queue--Time%2520Cards=1&Import--Customers=1&Import--Vendors=1&Import--Sales%2520Invoices=1&Import--Payments=1&Export--Payments=1&System--Audit%2520Control=1&System--Remove%2520Locks=1&System--Defaults=1&System--Bank%2520Accounts=1&System--Taxes=1&System--Yearend=1&System--Backup=1&System--Backup--Send%2520by%2520E-Mail=1&System--Backup--Save%2520to%2520File=1&System--Chart%2520of%2520Accounts=1&System--Chart%2520of%2520Accounts--Add%2520Account=1&System--Chart%2520of%2520Accounts--List%2520Accounts=1&System--Chart%2520of%2520Accounts--Translations=1&System--Chart%2520of%2520Accounts--Add%2520GIFI=1&System--Chart%2520of%2520Accounts--List%2520GIFI=1&System--Currencies=1&System--Currencies--Add%2520Currency=1&System--Currencies--List%2520Currencies=1&System--Payment%2520Method=1&System--Payment%2520Method--Add%2520Method=1&System--Payment%2520Method--List%2520Methods=1&System--Warehouses=1&System--Warehouses--Add%2520Warehouse=1&System--Warehouses--List%2520Warehouses=1&System--Departments=1&System--Departments--Add%2520Department=1&System--Departments--List%2520Departments=1&System--Type%2520of%2520Business=1&System--Type%2520of%2520Business--Add%2520Business=1&System--Type%2520of%2520Business--List%2520Businesses=1&System--Language=1&System--Language--Add%2520Language=1&System--Language--List%2520Languages=1&System--SIC=1&System--SIC--Add%2520SIC=1&System--SIC--List%2520SIC=1&System--Mapfile=1&System--HTML%2520Templates=1&System--HTML%2520Templates--Income%2520Statement=1&System--HTML%2520Templates--Balance%2520Sheet=1&System--HTML%2520Templates--Sales%2520Invoice=1&System--HTML%2520Templates--Credit%2520Invoice=1&System--HTML%2520Templates--Vendor%2520Invoice=1&System--HTML%2520Templates--Debit%2520Invoice=1&System--HTML%2520Templates--AR%2520Transaction=1&System--HTML%2520Templates--AP%2520Transaction=1&System--HTML%2520Templates--Credit%2520Note=1&System--HTML%2520Templates--Debit%2520Note=1&System--HTML%2520Templates--Remittance%2520Voucher=1&System--HTML%2520Templates--Packing%2520List=1&System--HTML%2520Templates--Pick%2520List=1&System--HTML%2520Templates--Sales%2520Order=1&System--HTML%2520Templates--Work%2520Order=1&System--HTML%2520Templates--Purchase%2520Order=1&System--HTML%2520Templates--Bin%2520List=1&System--HTML%2520Templates--Statement=1&System--HTML%2520Templates--1.Reminder=1&System--HTML%2520Templates--2.Reminder=1&System--HTML%2520Templates--3.Reminder=1&System--HTML%2520Templates--Quotation=1&System--HTML%2520Templates--RFQ=1&System--HTML%2520Templates--Time%2520Card=1&System--LaTeX%2520Templates=1&System--LaTeX%2520Templates--Sales%2520Invoice=1&System--LaTeX%2520Templates--Credit%2520Invoice=1&System--LaTeX%2520Templates--Vendor%2520Invoice=1&System--LaTeX%2520Templates--Debit%2520Invoice=1&System--LaTeX%2520Templates--AR%2520Transaction=1&System--LaTeX%2520Templates--AP%2520Transaction=1&System--LaTeX%2520Templates--Credit%2520Note=1&System--LaTeX%2520Templates--Debit%2520Note=1&System--LaTeX%2520Templates--Remittance%2520Voucher=1&System--LaTeX%2520Templates--Packing%2520List=1&System--LaTeX%2520Templates--Pick%2520List=1&System--LaTeX%2520Templates--Sales%2520Order=1&System--LaTeX%2520Templates--Work%2520Order=1&System--LaTeX%2520Templates--Purchase%2520Order=1&System--LaTeX%2520Templates--Bin%2520List=1&System--LaTeX%2520Templates--Statement=1&System--LaTeX%2520Templates--1.Reminder=1&System--LaTeX%2520Templates--2.Reminder=1&System--LaTeX%2520Templates--3.Reminder=1&System--LaTeX%2520Templates--Check=1&System--LaTeX%2520Templates--Receipt=1&System--LaTeX%2520Templates--Quotation=1&System--LaTeX%2520Templates--RFQ=1&System--LaTeX%2520Templates--Time%2520Card=1&System--Text%2520Templates=1&System--Text%2520Templates--POS%2520Invoice=1&Stylesheet--Stylesheet=1&Preferences--Preferences=1&Version--Version=1&New%2520Window--New%2520Window=1&Logout--Logout=1&acs=AR--AR%3BAR--Add%2520Transaction%3BAR--Sales%2520Invoice%3BAR--Credit%2520Note%3BAR--Credit%2520Invoice%3BAR--Reports%3BAR--Reports--Transactions%3BAR--Reports--Outstanding%3BAR--Reports--AR%2520Aging%3BAR--Reports--Reminder%3BAR--Reports--Tax%2520collected%3BAR--Reports--Non-taxable%3BPOS--POS%3BPOS--Sale%3BPOS--Open%3BPOS--Receipts%3BCustomers--Customers%3BCustomers--Add%2520Customer%3BCustomers--Reports%3BCustomers--Reports--Search%3BCustomers--Reports--History%3BAP--AP%3BAP--Add%2520Transaction%3BAP--Vendor%2520Invoice%3BAP--Debit%2520Note%3BAP--Debit%2520Invoice%3BAP--Reports%3BAP--Reports--Transactions%3BAP--Reports--Outstanding%3BAP--Reports--AP%2520Aging%3BAP--Reports--Tax%2520paid%3BAP--Reports--Non-taxable%3BVendors--Vendors%3BVendors--Add%2520Vendor%3BVendors--Reports%3BVendors--Reports--Search%3BVendors--Reports--History%3BCash--Cash%3BCash--Receipt%3BCash--Receipts%3BCash--Payment%3BCash--Payments%3BCash--FX%2520Adjustment%3BCash--Reconciliation%3BCash--Reports%3BCash--Reports--Receipts%3BCash--Reports--Payments%3BCash--Reports--Reconciliation%3BVouchers--Vouchers%3BVouchers--Payable%3BVouchers--Payment%3BVouchers--Payments%3BVouchers--Payment%2520Reversal%3BVouchers--General%2520Ledger%3BVouchers--Reports%3BVouchers--Reports--All%2520Batches%3BVouchers--Reports--Payable%3BVouchers--Reports--Payment%3BVouchers--Reports--Payment%2520Reversal%3BVouchers--Reports--General%2520Ledger%3BHR--HR%3BHR--Employees%3BHR--Employees--Add%2520Employee%3BHR--Employees--Reports%3BOrder%2520Entry--Order%2520Entry%3BOrder%2520Entry--Sales%2520Order%3BOrder%2520Entry--Purchase%2520Order%3BOrder%2520Entry--Reports%3BOrder%2520Entry--Reports--Sales%2520Orders%3BOrder%2520Entry--Reports--Requirements%3BOrder%2520Entry--Reports--Purchase%2520Orders%3BOrder%2520Entry--Generate%3BOrder%2520Entry--Generate--Purchase%2520Orders%3BOrder%2520Entry--Consolidate%3BOrder%2520Entry--Consolidate--Sales%2520Orders%3BOrder%2520Entry--Consolidate--Purchase%2520Orders%3BShipping--Shipping%3BShipping--Ship%3BShipping--Receive%3BQuotations--Quotations%3BQuotations--Quotation%3BQuotations--RFQ%3BQuotations--Reports%3BQuotations--Reports--Quotations%3BQuotations--Reports--RFQs%3BGeneral%2520Ledger--General%2520Ledger%3BGeneral%2520Ledger--Add%2520Transaction%3BGeneral%2520Ledger--Reports%3BGoods%2520%2526%2520Services--Goods%2520%2526%2520Services%3BGoods%2520%2526%2520Services--Add%2520Part%3BGoods%2520%2526%2520Services--Add%2520Service%3BGoods%2520%2526%2520Services--Add%2520Assembly%3BGoods%2520%2526%2520Services--Add%2520Labor%252fOverhead%3BGoods%2520%2526%2520Services--Add%2520Group%3BGoods%2520%2526%2520Services--Add%2520Pricegroup%3BGoods%2520%2526%2520Services--Stock%2520Assembly%3BGoods%2520%2526%2520Services--Changeup%3BGoods%2520%2526%2520Services--Changeup--Assembly%3BGoods%2520%2526%2520Services--Changeup--Part%3BGoods%2520%2526%2520Services--Changeup--Service%3BGoods%2520%2526%2520Services--Changeup--Labor%252fOverhead%3BGoods%2520%2526%2520Services--Reports%3BGoods%2520%2526%2520Services--Reports--All%2520Items%3BGoods%2520%2526%2520Services--Reports--Parts%3BGoods%2520%2526%2520Services--Reports--Requirements%3BGoods%2520%2526%2520Services--Reports--Services%3BGoods%2520%2526%2520Services--Reports--Labor%252fOverhead%3BGoods%2520%2526%2520Services--Reports--Groups%3BGoods%2520%2526%2520Services--Reports--Pricegroups%3BGoods%2520%2526%2520Services--Reports--Assemblies%3BGoods%2520%2526%2520Services--Reports--Components%3BGoods%2520%2526%2520Services--Translations%3BGoods%2520%2526%2520Services--Translations--Description%3BGoods%2520%2526%2520Services--Translations--Groups%3BProjects--Projects%3BProjects--Add%2520Project%3BProjects--Add%2520Time%2520Card%3BProjects--Reports%3BProjects--Reports--List%2520Projects%3BProjects--Reports--Transactions%3BProjects--Reports--Time%2520Cards%3BProjects--Generate%3BProjects--Generate--Sales%2520Orders%3BProjects--Translations%3BProjects--Translations--Description%3BReports--Reports%3BReports--Chart%2520of%2520Accounts%3BReports--Trial%2520Balance%3BReports--Income%2520Statement%3BReports--Balance%2520Sheet%3BRecurring%2520Transactions--Recurring%2520Transactions%3BBatch--Batch%3BBatch--Print%3BBatch--Print--Sales%2520Invoices%3BBatch--Print--Remittance%2520Vouchers%3BBatch--Print--Sales%2520Orders%3BBatch--Print--Work%2520Orders%3BBatch--Print--Quotations%3BBatch--Print--Packing%2520Lists%3BBatch--Print--Pick%2520Lists%3BBatch--Print--Vendor%2520Invoices%3BBatch--Print--Purchase%2520Orders%3BBatch--Print--Bin%2520Lists%3BBatch--Print--RFQs%3BBatch--Print--Time%2520Cards%3BBatch--Email%3BBatch--Email--Sales%2520Invoices%3BBatch--Email--Remittance%2520Vouchers%3BBatch--Email--Sales%2520Orders%3BBatch--Email--Work%2520Orders%3BBatch--Email--Quotations%3BBatch--Email--Packing%2520Lists%3BBatch--Email--Pick%2520Lists%3BBatch--Email--Vendor%2520Invoices%3BBatch--Email--Purchase%2520Orders%3BBatch--Email--Bin%2520Lists%3BBatch--Email--RFQs%3BBatch--Queue%3BBatch--Queue--Sales%2520Invoices%3BBatch--Queue--Remittance%2520Vouchers%3BBatch--Queue--Sales%2520Orders%3BBatch--Queue--Work%2520Orders%3BBatch--Queue--Quotations%3BBatch--Queue--Packing%2520Lists%3BBatch--Queue--Pick%2520Lists%3BBatch--Queue--Vendor%2520Invoices%3BBatch--Queue--Purchase%2520Orders%3BBatch--Queue--Bin%2520Lists%3BBatch--Queue--RFQs%3BBatch--Queue--Time%2520Cards%3BExchange%2520Rates--Exchange%2520Rates%3BImport--Import%3BImport--Customers%3BImport--Vendors%3BImport--Sales%2520Invoices%3BImport--Payments%3BExport--Export%3BExport--Payments%3BSystem--System%3BSystem--Audit%2520Control%3BSystem--Remove%2520Locks%3BSystem--Defaults%3BSystem--Bank%2520Accounts%3BSystem--Taxes%3BSystem--Yearend%3BSystem--Backup%3BSystem--Backup--Send%2520by%2520E-Mail%3BSystem--Backup--Save%2520to%2520File%3BSystem--Chart%2520of%2520Accounts%3BSystem--Chart%2520of%2520Accounts--Add%2520Account%3BSystem--Chart%2520of%2520Accounts--List%2520Accounts%3BSystem--Chart%2520of%2520Accounts--Translations%3BSystem--Chart%2520of%2520Accounts--Add%2520GIFI%3BSystem--Chart%2520of%2520Accounts--List%2520GIFI%3BSystem--Currencies%3BSystem--Currencies--Add%2520Currency%3BSystem--Currencies--List%2520Currencies%3BSystem--Payment%2520Method%3BSystem--Payment%2520Method--Add%2520Method%3BSystem--Payment%2520Method--List%2520Methods%3BSystem--Warehouses%3BSystem--Warehouses--Add%2520Warehouse%3BSystem--Warehouses--List%2520Warehouses%3BSystem--Departments%3BSystem--Departments--Add%2520Department%3BSystem--Departments--List%2520Departments%3BSystem--Type%2520of%2520Business%3BSystem--Type%2520of%2520Business--Add%2520Business%3BSystem--Type%2520of%2520Business--List%2520Businesses%3BSystem--Language%3BSystem--Language--Add%2520Language%3BSystem--Language--List%2520Languages%3BSystem--SIC%3BSystem--SIC--Add%2520SIC%3BSystem--SIC--List%2520SIC%3BSystem--Mapfile%3BSystem--HTML%2520Templates%3BSystem--HTML%2520Templates--Income%2520Statement%3BSystem--HTML%2520Templates--Balance%2520Sheet%3BSystem--HTML%2520Templates--Sales%2520Invoice%3BSystem--HTML%2520Templates--Credit%2520Invoice%3BSystem--HTML%2520Templates--Vendor%2520Invoice%3BSystem--HTML%2520Templates--Debit%2520Invoice%3BSystem--HTML%2520Templates--AR%2520Transaction%3BSystem--HTML%2520Templates--AP%2520Transaction%3BSystem--HTML%2520Templates--Credit%2520Note%3BSystem--HTML%2520Templates--Debit%2520Note%3BSystem--HTML%2520Templates--Remittance%2520Voucher%3BSystem--HTML%2520Templates--Packing%2520List%3BSystem--HTML%2520Templates--Pick%2520List%3BSystem--HTML%2520Templates--Sales%2520Order%3BSystem--HTML%2520Templates--Work%2520Order%3BSystem--HTML%2520Templates--Purchase%2520Order%3BSystem--HTML%2520Templates--Bin%2520List%3BSystem--HTML%2520Templates--Statement%3BSystem--HTML%2520Templates--1.Reminder%3BSystem--HTML%2520Templates--2.Reminder%3BSystem--HTML%2520Templates--3.Reminder%3BSystem--HTML%2520Templates--Quotation%3BSystem--HTML%2520Templates--RFQ%3BSystem--HTML%2520Templates--Time%2520Card%3BSystem--LaTeX%2520Templates%3BSystem--LaTeX%2520Templates--Sales%2520Invoice%3BSystem--LaTeX%2520Templates--Credit%2520Invoice%3BSystem--LaTeX%2520Templates--Vendor%2520Invoice%3BSystem--LaTeX%2520Templates--Debit%2520Invoice%3BSystem--LaTeX%2520Templates--AR%2520Transaction%3BSystem--LaTeX%2520Templates--AP%2520Transaction%3BSystem--LaTeX%2520Templates--Credit%2520Note%3BSystem--LaTeX%2520Templates--Debit%2520Note%3BSystem--LaTeX%2520Templates--Remittance%2520Voucher%3BSystem--LaTeX%2520Templates--Packing%2520List%3BSystem--LaTeX%2520Templates--Pick%2520List%3BSystem--LaTeX%2520Templates--Sales%2520Order%3BSystem--LaTeX%2520Templates--Work%2520Order%3BSystem--LaTeX%2520Templates--Purchase%2520Order%3BSystem--LaTeX%2520Templates--Bin%2520List%3BSystem--LaTeX%2520Templates--Statement%3BSystem--LaTeX%2520Templates--1.Reminder%3BSystem--LaTeX%2520Templates--2.Reminder%3BSystem--LaTeX%2520Templates--3.Reminder%3BSystem--LaTeX%2520Templates--Check%3BSystem--LaTeX%2520Templates--Receipt%3BSystem--LaTeX%2520Templates--Quotation%3BSystem--LaTeX%2520Templates--RFQ%3BSystem--LaTeX%2520Templates--Time%2520Card%3BSystem--Text%2520Templates%3BSystem--Text%2520Templates--POS%2520Invoice%3BStylesheet--Stylesheet%3BPreferences--Preferences%3BVersion--Version%3BNew%2520Window--New%2520Window%3BLogout--Logout%3B&callback=admin.pl%3Faction%3Dlist_users%26path%3Dbin%2Fmozilla&path=bin%2Fmozilla&action=Save"
else
	# Admin user
	CURL "login=${USERNAME}&new_password=${USER_PASSWORD}&old_password=&name=${USER_FULL_NAME_ENCODED}&email=${USER_EMAIL_ENCODED}&signature=&tel=&fax=&company=${COMPANY_NAME_ENCODED}&dateformat=mm-dd-yy&numberformat=1%2C000.00&vclimit=1000&menuwidth=155&countrycode=&newtimeout=10800&userstylesheet=sql-ledger.css&printer=&newtemplates=default&mastertemplates=Default&templates=&dbdriver=Pg&Pg_dbhost=pgsql.${DOMAIN}&Pg_dbname=sql-ledger&Pg_dbport=5432&Pg_dbuser=sql-ledger&Pg_dbpasswd=${DB_PASSWORD_SQL_LEDGER}&old_dbpasswd=&role=admin&AR--AR=1&AR--Add%2520Transaction=1&AR--Sales%2520Invoice=1&AR--Credit%2520Note=1&AR--Credit%2520Invoice=1&AR--Reports=1&AR--Reports--Transactions=1&AR--Reports--Outstanding=1&AR--Reports--AR%2520Aging=1&AR--Reports--Reminder=1&AR--Reports--Tax%2520collected=1&AR--Reports--Non-taxable=1&POS--POS=1&POS--Sale=1&POS--Open=1&POS--Receipts=1&Customers--Customers=1&Customers--Add%2520Customer=1&Customers--Reports=1&Customers--Reports--Search=1&Customers--Reports--History=1&AP--AP=1&AP--Add%2520Transaction=1&AP--Vendor%2520Invoice=1&AP--Debit%2520Note=1&AP--Debit%2520Invoice=1&AP--Reports=1&AP--Reports--Transactions=1&AP--Reports--Outstanding=1&AP--Reports--AP%2520Aging=1&AP--Reports--Tax%2520paid=1&AP--Reports--Non-taxable=1&Vendors--Vendors=1&Vendors--Add%2520Vendor=1&Vendors--Reports=1&Vendors--Reports--Search=1&Vendors--Reports--History=1&Cash--Cash=1&Cash--Receipt=1&Cash--Receipts=1&Cash--Payment=1&Cash--Payments=1&Cash--FX%2520Adjustment=1&Cash--Reconciliation=1&Cash--Reports=1&Cash--Reports--Receipts=1&Cash--Reports--Payments=1&Cash--Reports--Reconciliation=1&Vouchers--Vouchers=1&Vouchers--Payable=1&Vouchers--Payment=1&Vouchers--Payments=1&Vouchers--Payment%2520Reversal=1&Vouchers--General%2520Ledger=1&Vouchers--Reports=1&Vouchers--Reports--All%2520Batches=1&Vouchers--Reports--Payable=1&Vouchers--Reports--Payment=1&Vouchers--Reports--Payment%2520Reversal=1&Vouchers--Reports--General%2520Ledger=1&HR--HR=1&HR--Employees=1&HR--Employees--Add%2520Employee=1&HR--Employees--Reports=1&Order%2520Entry--Order%2520Entry=1&Order%2520Entry--Sales%2520Order=1&Order%2520Entry--Purchase%2520Order=1&Order%2520Entry--Reports=1&Order%2520Entry--Reports--Sales%2520Orders=1&Order%2520Entry--Reports--Requirements=1&Order%2520Entry--Reports--Purchase%2520Orders=1&Order%2520Entry--Generate=1&Order%2520Entry--Generate--Purchase%2520Orders=1&Order%2520Entry--Consolidate=1&Order%2520Entry--Consolidate--Sales%2520Orders=1&Order%2520Entry--Consolidate--Purchase%2520Orders=1&Shipping--Shipping=1&Shipping--Ship=1&Shipping--Receive=1&Quotations--Quotations=1&Quotations--Quotation=1&Quotations--RFQ=1&Quotations--Reports=1&Quotations--Reports--Quotations=1&Quotations--Reports--RFQs=1&General%2520Ledger--General%2520Ledger=1&General%2520Ledger--Add%2520Transaction=1&General%2520Ledger--Reports=1&Goods%2520%2526%2520Services--Goods%2520%2526%2520Services=1&Goods%2520%2526%2520Services--Add%2520Part=1&Goods%2520%2526%2520Services--Add%2520Service=1&Goods%2520%2526%2520Services--Add%2520Assembly=1&Goods%2520%2526%2520Services--Add%2520Labor%252fOverhead=1&Goods%2520%2526%2520Services--Add%2520Group=1&Goods%2520%2526%2520Services--Add%2520Pricegroup=1&Goods%2520%2526%2520Services--Stock%2520Assembly=1&Goods%2520%2526%2520Services--Changeup=1&Goods%2520%2526%2520Services--Changeup--Assembly=1&Goods%2520%2526%2520Services--Changeup--Part=1&Goods%2520%2526%2520Services--Changeup--Service=1&Goods%2520%2526%2520Services--Changeup--Labor%252fOverhead=1&Goods%2520%2526%2520Services--Reports=1&Goods%2520%2526%2520Services--Reports--All%2520Items=1&Goods%2520%2526%2520Services--Reports--Parts=1&Goods%2520%2526%2520Services--Reports--Requirements=1&Goods%2520%2526%2520Services--Reports--Services=1&Goods%2520%2526%2520Services--Reports--Labor%252fOverhead=1&Goods%2520%2526%2520Services--Reports--Groups=1&Goods%2520%2526%2520Services--Reports--Pricegroups=1&Goods%2520%2526%2520Services--Reports--Assemblies=1&Goods%2520%2526%2520Services--Reports--Components=1&Goods%2520%2526%2520Services--Translations=1&Goods%2520%2526%2520Services--Translations--Description=1&Goods%2520%2526%2520Services--Translations--Groups=1&Projects--Projects=1&Projects--Add%2520Project=1&Projects--Add%2520Time%2520Card=1&Projects--Reports=1&Projects--Reports--List%2520Projects=1&Projects--Reports--Transactions=1&Projects--Reports--Time%2520Cards=1&Projects--Generate=1&Projects--Generate--Sales%2520Orders=1&Projects--Translations=1&Projects--Translations--Description=1&Reports--Reports=1&Reports--Chart%2520of%2520Accounts=1&Reports--Trial%2520Balance=1&Reports--Income%2520Statement=1&Reports--Balance%2520Sheet=1&Recurring%2520Transactions--Recurring%2520Transactions=1&Batch--Batch=1&Batch--Print=1&Batch--Print--Sales%2520Invoices=1&Batch--Print--Remittance%2520Vouchers=1&Batch--Print--Sales%2520Orders=1&Batch--Print--Work%2520Orders=1&Batch--Print--Quotations=1&Batch--Print--Packing%2520Lists=1&Batch--Print--Pick%2520Lists=1&Batch--Print--Vendor%2520Invoices=1&Batch--Print--Purchase%2520Orders=1&Batch--Print--Bin%2520Lists=1&Batch--Print--RFQs=1&Batch--Print--Time%2520Cards=1&Batch--Email=1&Batch--Email--Sales%2520Invoices=1&Batch--Email--Remittance%2520Vouchers=1&Batch--Email--Sales%2520Orders=1&Batch--Email--Work%2520Orders=1&Batch--Email--Quotations=1&Batch--Email--Packing%2520Lists=1&Batch--Email--Pick%2520Lists=1&Batch--Email--Vendor%2520Invoices=1&Batch--Email--Purchase%2520Orders=1&Batch--Email--Bin%2520Lists=1&Batch--Email--RFQs=1&Batch--Queue=1&Batch--Queue--Sales%2520Invoices=1&Batch--Queue--Remittance%2520Vouchers=1&Batch--Queue--Sales%2520Orders=1&Batch--Queue--Work%2520Orders=1&Batch--Queue--Quotations=1&Batch--Queue--Packing%2520Lists=1&Batch--Queue--Pick%2520Lists=1&Batch--Queue--Vendor%2520Invoices=1&Batch--Queue--Purchase%2520Orders=1&Batch--Queue--Bin%2520Lists=1&Batch--Queue--RFQs=1&Batch--Queue--Time%2520Cards=1&Exchange%2520Rates--Exchange%2520Rates=1&Import--Import=1&Import--Customers=1&Import--Vendors=1&Import--Sales%2520Invoices=1&Import--Payments=1&Export--Export=1&Export--Payments=1&System--System=1&System--Audit%2520Control=1&System--Remove%2520Locks=1&System--Defaults=1&System--Bank%2520Accounts=1&System--Taxes=1&System--Yearend=1&System--Backup=1&System--Backup--Send%2520by%2520E-Mail=1&System--Backup--Save%2520to%2520File=1&System--Chart%2520of%2520Accounts=1&System--Chart%2520of%2520Accounts--Add%2520Account=1&System--Chart%2520of%2520Accounts--List%2520Accounts=1&System--Chart%2520of%2520Accounts--Translations=1&System--Chart%2520of%2520Accounts--Add%2520GIFI=1&System--Chart%2520of%2520Accounts--List%2520GIFI=1&System--Currencies=1&System--Currencies--Add%2520Currency=1&System--Currencies--List%2520Currencies=1&System--Payment%2520Method=1&System--Payment%2520Method--Add%2520Method=1&System--Payment%2520Method--List%2520Methods=1&System--Warehouses=1&System--Warehouses--Add%2520Warehouse=1&System--Warehouses--List%2520Warehouses=1&System--Departments=1&System--Departments--Add%2520Department=1&System--Departments--List%2520Departments=1&System--Type%2520of%2520Business=1&System--Type%2520of%2520Business--Add%2520Business=1&System--Type%2520of%2520Business--List%2520Businesses=1&System--Language=1&System--Language--Add%2520Language=1&System--Language--List%2520Languages=1&System--SIC=1&System--SIC--Add%2520SIC=1&System--SIC--List%2520SIC=1&System--Mapfile=1&System--HTML%2520Templates=1&System--HTML%2520Templates--Income%2520Statement=1&System--HTML%2520Templates--Balance%2520Sheet=1&System--HTML%2520Templates--Sales%2520Invoice=1&System--HTML%2520Templates--Credit%2520Invoice=1&System--HTML%2520Templates--Vendor%2520Invoice=1&System--HTML%2520Templates--Debit%2520Invoice=1&System--HTML%2520Templates--AR%2520Transaction=1&System--HTML%2520Templates--AP%2520Transaction=1&System--HTML%2520Templates--Credit%2520Note=1&System--HTML%2520Templates--Debit%2520Note=1&System--HTML%2520Templates--Remittance%2520Voucher=1&System--HTML%2520Templates--Packing%2520List=1&System--HTML%2520Templates--Pick%2520List=1&System--HTML%2520Templates--Sales%2520Order=1&System--HTML%2520Templates--Work%2520Order=1&System--HTML%2520Templates--Purchase%2520Order=1&System--HTML%2520Templates--Bin%2520List=1&System--HTML%2520Templates--Statement=1&System--HTML%2520Templates--1.Reminder=1&System--HTML%2520Templates--2.Reminder=1&System--HTML%2520Templates--3.Reminder=1&System--HTML%2520Templates--Quotation=1&System--HTML%2520Templates--RFQ=1&System--HTML%2520Templates--Time%2520Card=1&System--LaTeX%2520Templates=1&System--LaTeX%2520Templates--Sales%2520Invoice=1&System--LaTeX%2520Templates--Credit%2520Invoice=1&System--LaTeX%2520Templates--Vendor%2520Invoice=1&System--LaTeX%2520Templates--Debit%2520Invoice=1&System--LaTeX%2520Templates--AR%2520Transaction=1&System--LaTeX%2520Templates--AP%2520Transaction=1&System--LaTeX%2520Templates--Credit%2520Note=1&System--LaTeX%2520Templates--Debit%2520Note=1&System--LaTeX%2520Templates--Remittance%2520Voucher=1&System--LaTeX%2520Templates--Packing%2520List=1&System--LaTeX%2520Templates--Pick%2520List=1&System--LaTeX%2520Templates--Sales%2520Order=1&System--LaTeX%2520Templates--Work%2520Order=1&System--LaTeX%2520Templates--Purchase%2520Order=1&System--LaTeX%2520Templates--Bin%2520List=1&System--LaTeX%2520Templates--Statement=1&System--LaTeX%2520Templates--1.Reminder=1&System--LaTeX%2520Templates--2.Reminder=1&System--LaTeX%2520Templates--3.Reminder=1&System--LaTeX%2520Templates--Check=1&System--LaTeX%2520Templates--Receipt=1&System--LaTeX%2520Templates--Quotation=1&System--LaTeX%2520Templates--RFQ=1&System--LaTeX%2520Templates--Time%2520Card=1&System--Text%2520Templates=1&System--Text%2520Templates--POS%2520Invoice=1&Stylesheet--Stylesheet=1&Preferences--Preferences=1&Version--Version=1&New%2520Window--New%2520Window=1&Logout--Logout=1&acs=AR--AR%3BAR--Add%2520Transaction%3BAR--Sales%2520Invoice%3BAR--Credit%2520Note%3BAR--Credit%2520Invoice%3BAR--Reports%3BAR--Reports--Transactions%3BAR--Reports--Outstanding%3BAR--Reports--AR%2520Aging%3BAR--Reports--Reminder%3BAR--Reports--Tax%2520collected%3BAR--Reports--Non-taxable%3BPOS--POS%3BPOS--Sale%3BPOS--Open%3BPOS--Receipts%3BCustomers--Customers%3BCustomers--Add%2520Customer%3BCustomers--Reports%3BCustomers--Reports--Search%3BCustomers--Reports--History%3BAP--AP%3BAP--Add%2520Transaction%3BAP--Vendor%2520Invoice%3BAP--Debit%2520Note%3BAP--Debit%2520Invoice%3BAP--Reports%3BAP--Reports--Transactions%3BAP--Reports--Outstanding%3BAP--Reports--AP%2520Aging%3BAP--Reports--Tax%2520paid%3BAP--Reports--Non-taxable%3BVendors--Vendors%3BVendors--Add%2520Vendor%3BVendors--Reports%3BVendors--Reports--Search%3BVendors--Reports--History%3BCash--Cash%3BCash--Receipt%3BCash--Receipts%3BCash--Payment%3BCash--Payments%3BCash--FX%2520Adjustment%3BCash--Reconciliation%3BCash--Reports%3BCash--Reports--Receipts%3BCash--Reports--Payments%3BCash--Reports--Reconciliation%3BVouchers--Vouchers%3BVouchers--Payable%3BVouchers--Payment%3BVouchers--Payments%3BVouchers--Payment%2520Reversal%3BVouchers--General%2520Ledger%3BVouchers--Reports%3BVouchers--Reports--All%2520Batches%3BVouchers--Reports--Payable%3BVouchers--Reports--Payment%3BVouchers--Reports--Payment%2520Reversal%3BVouchers--Reports--General%2520Ledger%3BHR--HR%3BHR--Employees%3BHR--Employees--Add%2520Employee%3BHR--Employees--Reports%3BOrder%2520Entry--Order%2520Entry%3BOrder%2520Entry--Sales%2520Order%3BOrder%2520Entry--Purchase%2520Order%3BOrder%2520Entry--Reports%3BOrder%2520Entry--Reports--Sales%2520Orders%3BOrder%2520Entry--Reports--Requirements%3BOrder%2520Entry--Reports--Purchase%2520Orders%3BOrder%2520Entry--Generate%3BOrder%2520Entry--Generate--Purchase%2520Orders%3BOrder%2520Entry--Consolidate%3BOrder%2520Entry--Consolidate--Sales%2520Orders%3BOrder%2520Entry--Consolidate--Purchase%2520Orders%3BShipping--Shipping%3BShipping--Ship%3BShipping--Receive%3BQuotations--Quotations%3BQuotations--Quotation%3BQuotations--RFQ%3BQuotations--Reports%3BQuotations--Reports--Quotations%3BQuotations--Reports--RFQs%3BGeneral%2520Ledger--General%2520Ledger%3BGeneral%2520Ledger--Add%2520Transaction%3BGeneral%2520Ledger--Reports%3BGoods%2520%2526%2520Services--Goods%2520%2526%2520Services%3BGoods%2520%2526%2520Services--Add%2520Part%3BGoods%2520%2526%2520Services--Add%2520Service%3BGoods%2520%2526%2520Services--Add%2520Assembly%3BGoods%2520%2526%2520Services--Add%2520Labor%252fOverhead%3BGoods%2520%2526%2520Services--Add%2520Group%3BGoods%2520%2526%2520Services--Add%2520Pricegroup%3BGoods%2520%2526%2520Services--Stock%2520Assembly%3BGoods%2520%2526%2520Services--Changeup%3BGoods%2520%2526%2520Services--Changeup--Assembly%3BGoods%2520%2526%2520Services--Changeup--Part%3BGoods%2520%2526%2520Services--Changeup--Service%3BGoods%2520%2526%2520Services--Changeup--Labor%252fOverhead%3BGoods%2520%2526%2520Services--Reports%3BGoods%2520%2526%2520Services--Reports--All%2520Items%3BGoods%2520%2526%2520Services--Reports--Parts%3BGoods%2520%2526%2520Services--Reports--Requirements%3BGoods%2520%2526%2520Services--Reports--Services%3BGoods%2520%2526%2520Services--Reports--Labor%252fOverhead%3BGoods%2520%2526%2520Services--Reports--Groups%3BGoods%2520%2526%2520Services--Reports--Pricegroups%3BGoods%2520%2526%2520Services--Reports--Assemblies%3BGoods%2520%2526%2520Services--Reports--Components%3BGoods%2520%2526%2520Services--Translations%3BGoods%2520%2526%2520Services--Translations--Description%3BGoods%2520%2526%2520Services--Translations--Groups%3BProjects--Projects%3BProjects--Add%2520Project%3BProjects--Add%2520Time%2520Card%3BProjects--Reports%3BProjects--Reports--List%2520Projects%3BProjects--Reports--Transactions%3BProjects--Reports--Time%2520Cards%3BProjects--Generate%3BProjects--Generate--Sales%2520Orders%3BProjects--Translations%3BProjects--Translations--Description%3BReports--Reports%3BReports--Chart%2520of%2520Accounts%3BReports--Trial%2520Balance%3BReports--Income%2520Statement%3BReports--Balance%2520Sheet%3BRecurring%2520Transactions--Recurring%2520Transactions%3BBatch--Batch%3BBatch--Print%3BBatch--Print--Sales%2520Invoices%3BBatch--Print--Remittance%2520Vouchers%3BBatch--Print--Sales%2520Orders%3BBatch--Print--Work%2520Orders%3BBatch--Print--Quotations%3BBatch--Print--Packing%2520Lists%3BBatch--Print--Pick%2520Lists%3BBatch--Print--Vendor%2520Invoices%3BBatch--Print--Purchase%2520Orders%3BBatch--Print--Bin%2520Lists%3BBatch--Print--RFQs%3BBatch--Print--Time%2520Cards%3BBatch--Email%3BBatch--Email--Sales%2520Invoices%3BBatch--Email--Remittance%2520Vouchers%3BBatch--Email--Sales%2520Orders%3BBatch--Email--Work%2520Orders%3BBatch--Email--Quotations%3BBatch--Email--Packing%2520Lists%3BBatch--Email--Pick%2520Lists%3BBatch--Email--Vendor%2520Invoices%3BBatch--Email--Purchase%2520Orders%3BBatch--Email--Bin%2520Lists%3BBatch--Email--RFQs%3BBatch--Queue%3BBatch--Queue--Sales%2520Invoices%3BBatch--Queue--Remittance%2520Vouchers%3BBatch--Queue--Sales%2520Orders%3BBatch--Queue--Work%2520Orders%3BBatch--Queue--Quotations%3BBatch--Queue--Packing%2520Lists%3BBatch--Queue--Pick%2520Lists%3BBatch--Queue--Vendor%2520Invoices%3BBatch--Queue--Purchase%2520Orders%3BBatch--Queue--Bin%2520Lists%3BBatch--Queue--RFQs%3BBatch--Queue--Time%2520Cards%3BExchange%2520Rates--Exchange%2520Rates%3BImport--Import%3BImport--Customers%3BImport--Vendors%3BImport--Sales%2520Invoices%3BImport--Payments%3BExport--Export%3BExport--Payments%3BSystem--System%3BSystem--Audit%2520Control%3BSystem--Remove%2520Locks%3BSystem--Defaults%3BSystem--Bank%2520Accounts%3BSystem--Taxes%3BSystem--Yearend%3BSystem--Backup%3BSystem--Backup--Send%2520by%2520E-Mail%3BSystem--Backup--Save%2520to%2520File%3BSystem--Chart%2520of%2520Accounts%3BSystem--Chart%2520of%2520Accounts--Add%2520Account%3BSystem--Chart%2520of%2520Accounts--List%2520Accounts%3BSystem--Chart%2520of%2520Accounts--Translations%3BSystem--Chart%2520of%2520Accounts--Add%2520GIFI%3BSystem--Chart%2520of%2520Accounts--List%2520GIFI%3BSystem--Currencies%3BSystem--Currencies--Add%2520Currency%3BSystem--Currencies--List%2520Currencies%3BSystem--Payment%2520Method%3BSystem--Payment%2520Method--Add%2520Method%3BSystem--Payment%2520Method--List%2520Methods%3BSystem--Warehouses%3BSystem--Warehouses--Add%2520Warehouse%3BSystem--Warehouses--List%2520Warehouses%3BSystem--Departments%3BSystem--Departments--Add%2520Department%3BSystem--Departments--List%2520Departments%3BSystem--Type%2520of%2520Business%3BSystem--Type%2520of%2520Business--Add%2520Business%3BSystem--Type%2520of%2520Business--List%2520Businesses%3BSystem--Language%3BSystem--Language--Add%2520Language%3BSystem--Language--List%2520Languages%3BSystem--SIC%3BSystem--SIC--Add%2520SIC%3BSystem--SIC--List%2520SIC%3BSystem--Mapfile%3BSystem--HTML%2520Templates%3BSystem--HTML%2520Templates--Income%2520Statement%3BSystem--HTML%2520Templates--Balance%2520Sheet%3BSystem--HTML%2520Templates--Sales%2520Invoice%3BSystem--HTML%2520Templates--Credit%2520Invoice%3BSystem--HTML%2520Templates--Vendor%2520Invoice%3BSystem--HTML%2520Templates--Debit%2520Invoice%3BSystem--HTML%2520Templates--AR%2520Transaction%3BSystem--HTML%2520Templates--AP%2520Transaction%3BSystem--HTML%2520Templates--Credit%2520Note%3BSystem--HTML%2520Templates--Debit%2520Note%3BSystem--HTML%2520Templates--Remittance%2520Voucher%3BSystem--HTML%2520Templates--Packing%2520List%3BSystem--HTML%2520Templates--Pick%2520List%3BSystem--HTML%2520Templates--Sales%2520Order%3BSystem--HTML%2520Templates--Work%2520Order%3BSystem--HTML%2520Templates--Purchase%2520Order%3BSystem--HTML%2520Templates--Bin%2520List%3BSystem--HTML%2520Templates--Statement%3BSystem--HTML%2520Templates--1.Reminder%3BSystem--HTML%2520Templates--2.Reminder%3BSystem--HTML%2520Templates--3.Reminder%3BSystem--HTML%2520Templates--Quotation%3BSystem--HTML%2520Templates--RFQ%3BSystem--HTML%2520Templates--Time%2520Card%3BSystem--LaTeX%2520Templates%3BSystem--LaTeX%2520Templates--Sales%2520Invoice%3BSystem--LaTeX%2520Templates--Credit%2520Invoice%3BSystem--LaTeX%2520Templates--Vendor%2520Invoice%3BSystem--LaTeX%2520Templates--Debit%2520Invoice%3BSystem--LaTeX%2520Templates--AR%2520Transaction%3BSystem--LaTeX%2520Templates--AP%2520Transaction%3BSystem--LaTeX%2520Templates--Credit%2520Note%3BSystem--LaTeX%2520Templates--Debit%2520Note%3BSystem--LaTeX%2520Templates--Remittance%2520Voucher%3BSystem--LaTeX%2520Templates--Packing%2520List%3BSystem--LaTeX%2520Templates--Pick%2520List%3BSystem--LaTeX%2520Templates--Sales%2520Order%3BSystem--LaTeX%2520Templates--Work%2520Order%3BSystem--LaTeX%2520Templates--Purchase%2520Order%3BSystem--LaTeX%2520Templates--Bin%2520List%3BSystem--LaTeX%2520Templates--Statement%3BSystem--LaTeX%2520Templates--1.Reminder%3BSystem--LaTeX%2520Templates--2.Reminder%3BSystem--LaTeX%2520Templates--3.Reminder%3BSystem--LaTeX%2520Templates--Check%3BSystem--LaTeX%2520Templates--Receipt%3BSystem--LaTeX%2520Templates--Quotation%3BSystem--LaTeX%2520Templates--RFQ%3BSystem--LaTeX%2520Templates--Time%2520Card%3BSystem--Text%2520Templates%3BSystem--Text%2520Templates--POS%2520Invoice%3BStylesheet--Stylesheet%3BPreferences--Preferences%3BVersion--Version%3BNew%2520Window--New%2520Window%3BLogout--Logout%3B&callback=admin.pl%3Faction%3Dlist_users%26path%3Dbin%2Fmozilla&path=bin%2Fmozilla&action=Save"
fi

# Set back the password if it was set to something else than the default
if [ "$SQL_LEDGER_PASSWORD_ADMIN_ENCRYPTED" != "$SQL_LEDGER_PASSWORD_ADMIN_ACTUAL" ]; then
	awk -f $AWK_FOLDER/sql-ledger-members-set-password.awk -v PASSWORD="$SQL_LEDGER_PASSWORD_ADMIN_ACTUAL" /var/lib/sql-ledger/users/members >/var/lib/sql-ledger/users/members.tmp
	chown www-data:www-data /var/lib/sql-ledger/users/members.tmp
	mv /var/lib/sql-ledger/users/members.tmp /var/lib/sql-ledger/users/members
fi

# Clean up
rm -f $COOKIE

exit 0
